# プライバシーポリシー

施行日: 2025年9月25日

このプライバシーポリシーは、セルフホスト型Pay2Slayフォーセット（以下「ソフトウェア」）がユーザーデータをどのように処理するかを説明します。目標は最大限のプライバシーと最小限のデータ保持です。デプロイ担当者（以下「オペレーター」）はこれらの原則に従うか、改善することが期待されます。

## 基本方針
- データ最小化：報酬計算、不正防止、監査に厳密に必要なもののみを保存。
- デフォルトでローカルのみ：テレメトリ、広告、トラッキングビーコンは送信されません。すべてのメトリクス/トレースは、明示的に設定しない限りオペレーターのインフラ内に留まります。
- 一時性：揮発性または導出可能なデータ（例：セッション状態、一時的なOAuth交換）は機能的必要性を超えて永続化されません。
- ユーザーへの透明性：データカテゴリと目的は以下に文書化されており、隠れた処理はありません。
- オプトアウト対応：オプション機能（トレーシングエクスポート、拡張分析）は、オペレーターが有効にしない限り無効です。

## データカテゴリ
| カテゴリ | 例 | 目的 | 保持期間 | 備考 |
|---------|---|------|---------|------|
| 識別情報（Discord） | discord_user_id、username、ギルドメンバーシップフラグ | 報酬の適格性＋帰属 | アカウント削除リクエストまたはオペレーター削除まで | ID＋ギルドチェック以外の特権スコープは要求しません。 |
| 識別情報（Fortnite） | epic_account_id | キルデルタのユーザーへの紐付け | アカウント削除またはリンク解除まで | Yuniteマッピング経由で取得；外部共有なし。 |
| ウォレット | Bananoアドレス（プライマリ） | 報酬支払い | リンク解除または削除まで | 複数アドレスはオプション；支払いにはプライマリのみ使用。 |
| 報酬アクティビティ | RewardAccrual（キル数、金額、epoch_minute） | 報酬計算/不正監査 | 精算＋（オペレーター定義の監査期間）まで | 支払い確定後に削減可能。 |
| 支払い記録 | 金額、tx_hash、ステータス、試行メタデータ | 財務的説明責任/リトライ/紛争解決 | 無期限またはオペレーター定義 | tx_hashはオンチェーンで公開の場合あり。 |
| 検証イベント | VerificationRecord（ソース、ステータス、タイムスタンプ） | 検証履歴追跡/紛争解決 | ローリングウィンドウまたは無期限（オペレーター判断） | 積極的に削減可能（最後の成功のみ保持）。 |
| 不正フラグ | flag_type、severity、detail | 公正利用/整合性保護 | クリアまたはユーザー削除まで | ヒューリスティックサマリーのみ；IP保存なし。 |
| 寄付記録 | DonationLedger（amount_ban、blocks_received、source） | コミュニティ寄付追跡、マイルストーン進捗 | 無期限またはオペレーター定義 | 寄付者識別情報は保存されず、金額のみ。 |
| リージョンコード（概算） | 例：「eu」、「na」 | 不正分析、支払い分布統計 | オプション；無効化可能 | ヘッダーまたは概算IPマッピングから導出；正確なジオロケーションは決して使用しない。 |
| ログ（構造化） | イベント名、trace/span ID（有効時） | デバッグ＆監査 | 短期保持推奨（例：7〜30日） | マスキングヘルパーでシークレットを除外。 |
| セッション | HMACセッショントークン（Cookie） | 後続リクエストの認証 | メモリ内/Cookie TTLのみ | トークンは不透明でCookieクリアで失効可能。 |

## 意図的に収集しないもの
- メール、本名、生年月日、政府ID、電話番号は不要。
- 正確なジオロケーション、IP保持、サードパーティ分析IDは不要。
- 行動プロファイリングやマーケティングセグメンテーションは不要。
- 生体認証やセンシティブカテゴリデータは不要。

## オプション/オペレーター制御機能
| 機能 | デフォルト | プライバシーへの影響 | 緩和策 |
|------|----------|-------------------|--------|
| OpenTelemetryエクスポート | 無効 | スパンをエクスポートする可能性あり（ルート名、タイミングを含む） | エクスポートエンドポイントを内部に保つか無効のまま |
| 拡張リージョンミドルウェア | 有効（概算のみ） | 最小限の概算リージョンコード | 不要なら設定で無効化 |
| メトリクスエンドポイント（/metrics） | 有効 | 集約カウンターを公開 | ネットワークポリシー/認証ゲートウェイで保護 |
| ログ内トレースID | 有効（ローカル） | リクエストイベントを相関 | レビューなしにサードパーティへのログエクスポートを避ける |

## データ主体の権利
オペレーターは以下を提供すべきです（デプロイチャネル経由）：
- アクセス権：保存された識別情報と支払い履歴を閲覧するためのエンドポイントまたはプロセス（既存エンドポイント `/me/status`、`/me/payouts` で部分的にカバー）。
- 消去権：ユーザーの削除（または匿名化）のためのオペレータースクリプトまたは管理者アクション。ウォレットリンク、蓄積（精算済み）、フラグ、セッションにカスケード。
- 訂正権：Epicマッピング更新のための再検証トリガー（/me/reverifyまたは管理者再検証）。

## セキュリティ対策
- セッショントークンはHMACシークレットで署名（推測不可；内部にPIIなし）。
- 構造化ログでシークレットをマスキング（`safe_dict`）。
- レート制限と不正ヒューリスティクスで自動スクレイピング/列挙を低減。
- オプションのオペレーターバランスガードで意図しない空支払いを防止。

## 保持ガイダンス（推奨）
| データ | 推奨最大保持期間 | 廃棄方法 |
|--------|----------------|---------|
| 生の蓄積行 | 精算後30〜90日 | 削除または統計のみ集約 |
| 検証記録（最後の成功より古いもの） | 30日 | パージ |
| 不正フラグ（解決済み） | 90日 | パージ |
| ログ | 7〜30日 | ローテーション＋破棄 |
| メトリクスTSDB | 30〜90日 | 保持ポリシー |

## 国際・データ移転
ソフトウェアは、明示的に設定しない限り（例：外部トレーシングエンドポイント）、オペレーターのインフラ外にデータを送信しません。リージョン間移転の検討はオペレーターのホスティング選択に依存します。コード内に自動的な海外移転ロジックは存在しません。

## 児童のデータ
ソフトウェアは年齢指標の収集を目的としていません。オペレーターは管轄区域に従い、適切な対象者への宣伝を制限すべきです。

## ポリシーの変更
ソースコード管理でバージョン管理。重要な変更は施行日を更新し、コミットメッセージで差分を要約すべきです。

## 連絡先/ガバナンス
セルフホストプロジェクトとして、ガバナンスとコンプライアンスの責任は各オペレーターにあります。プライバシー強化のためのコミュニティ貢献はプルリクエストで歓迎します。

## オペレータークイックチェックリスト
- [ ] 必要でない限りOTLPエクスポートを無効化
- [ ] /metricsを認証またはネットワークポリシーで保護
- [ ] ログ保持を30日以下に設定
- [ ] 文書化されたユーザー削除手順を提供
- [ ] 精算済み蓄積と古い検証記録を定期的に削減
- [ ] 設定ファイルのシークレット露出をチェック

---
このポリシーは最小限の摩擦で最大限のプライバシーを目指しています。報酬の正確性を保ちながらより多くを削除または匿名化できる場合は、そうして改善を貢献してください。
